select * from ( select a.*,c.client_num,e.org_name,a.process_type as processType,a.client_type as clientType,a.trigger_type as triggerType,c.client_name from (select g.*,case when g.process_type = 3 then last_process_instance_id else process_instance_id end as new_process_instance_id from biz_process g) a,ref_entity_signal_task b,par_corp_cl c,sys_user_org d,sys_org e WHERE a.new_process_instance_id=b.process_instance_id and b.entity_id=c.client_num and a.create_by=d.user_id and d.org_id=e.org_id and a.client_type=2 and a.process_type!=1 AND a.create_by = 13 UNION ALL select a.*,c.client_num,e.org_name,a.process_type as processType,a.client_type as clientType,a.trigger_type as triggerType,c.client_name from (select g.*,case when g.process_type = 3 then last_process_instance_id else process_instance_id end as new_process_instance_id from biz_process g) a,ref_entity_signal_task b,par_individual_cl c,sys_user_org d,sys_org e WHERE a.new_process_instance_id=b.process_instance_id and b.entity_id=c.client_num and a.create_by=d.user_id and d.org_id=e.org_id and a.client_type=1 and a.process_type!=1 AND a.create_by = 13 ) v order by process_type desc,create_date desc;
